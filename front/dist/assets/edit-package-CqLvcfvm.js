import{c as L,r as p,j as e,C as I,B as T,b as C}from"./index-CqonvCgs.js";import"./react-datepicker-BBwLDICz.js";import{S as w}from"./react-select.esm-C0W1OJnW.js";import{F as n}from"./Form-BsIrG47u.js";import{R as x,C as m}from"./Row-kCx33sI5.js";import"./setPrototypeOf-DgZC2w_0.js";const V=()=>{const y=[{value:"Number",label:"Number"},{value:"Text",label:"Text"},{value:"Password",label:"Password"}],{id:g}=L(),[f,k]=p.useState([]);p.useState({name:"",details:"",actualinr:"",membersinr:"",brcoinsinr:"",actualusd:"",membersusd:"",brcoinsusd:""});const[v,F]=p.useState([]),[E,N]=p.useState([]),[t,h]=p.useState({name:"",task:"",features:[],selectedFeatureData:[],actualinr:"",membersinr:"",brcoinsinr:"",actualusd:"",membersusd:"",brcoinsusd:""}),b=r=>{let a=r.target.name,c=r.target.value;h({...t,[a]:c})},$=r=>{const a=r?r.map(s=>s.value):[],c=v.filter(s=>a.includes(s.value)&&!t.features.includes(s.value));h(s=>({...s,features:a})),N(s=>[...s.filter(i=>a.includes(i.value)),...c]),k(s=>s.filter(o=>a.includes(o.itemid)))},d=(r,a,c)=>{const{value:s}=r.target;k(o=>o.map((i,u)=>u===a?{...i,[c]:s}:i)),N(o=>o.map((i,u)=>u===a?{...i,[c]:s}:i))},B=async()=>{try{const a=await(await fetch("http://localhost:5000/api/package/getdataOptions",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),c=Array.isArray(a.msg)?a.msg.map(s=>{var o,i,u,l,P,D,S,R;return{value:s._id,label:((o=s.name)==null?void 0:o.trim())||s.name,details:((i=s.details)==null?void 0:i.trim())||s.details,actualinr:((u=s.actualinr)==null?void 0:u.trim())||s.actualinr,membersinr:((l=s.membersinr)==null?void 0:l.trim())||s.membersinr,brcoinsinr:((P=s.brcoinsinr)==null?void 0:P.trim())||s.brcoinsinr,actualusd:((D=s.actualusd)==null?void 0:D.trim())||s.actualusd,membersusd:((S=s.actualusd)==null?void 0:S.trim())||s.membersusd,brcoinsusd:((R=s.actualusd)==null?void 0:R.trim())||s.brcoinsusd}}):[];F(c)}catch(r){console.error("Error fetching options:",r)}},M=async()=>{try{const r=await fetch(`http://localhost:5000/api/package/getItempackges/${g}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Error: ${r.status}`);const a=await r.json();k(a.msg);const c=a.msg.map(s=>({packageid:s.packageid,itemid:s.itemid,itemname:s.itemname,actualinrpackage:s.actualinrpackage||"",membersinrpackage:s.membersinrpackage||"",brcoinsinrpackage:s.brcoinsinrpackage||"",actualusdpackage:s.actualusdpackage||"",membersusdpackage:s.membersusdpackage||"",brcoinsusdpackage:s.brcoinsusdpackage||""}));h(s=>({...s,selectedFeatureData:c}))}catch(r){console.error("Error fetching data:",r)}},[j,O]=p.useState({}),A=async r=>{r.preventDefault();const a={};if(t.name||(a.name="Name is required"),(!t.features||t.features.length===0)&&(a.features="Fixed Features are required"),t.task||(a.task="Task is required"),Object.keys(a).length>0){O(a);return}try{if(!g){C.error("Invalid Package ID");return}const c=f.map(l=>({itemname:l.itemname,itemid:l.itemid,actualinrpackage:l.actualinrpackage||"",membersinrpackage:l.membersinrpackage||"",brcoinsinrpackage:l.brcoinsinrpackage||"",actualusdpackage:l.actualusdpackage||"",membersusdpackage:l.membersusdpackage||"",brcoinsusdpackage:l.brcoinsusdpackage||""})),s=E.map(l=>({itemname:l.label,itemid:l.value,actualinrpackage:l.actualinr||"",membersinrpackage:l.membersinr||"",brcoinsinrpackage:l.brcoinsinr||"",actualusdpackage:l.actualusd||"",membersusdpackage:l.membersusd||"",brcoinsusdpackage:l.brcoinsusd||""})),o={name:t.name,task:t.task,features:Array.isArray(t.features)?t.features:[],actualinr:t.actualinr,membersinr:t.membersinr,brcoinsinr:t.brcoinsinr,actualusd:t.actualusd,membersusd:t.membersusd,brcoinsusd:t.brcoinsusd,featureData:c,featureData2:s};console.log("Sending request with payload:",o);const i=await fetch(`http://localhost:5000/api/package/editpackage/${g}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),u=await i.json();i.ok?(C.success("Package Updated Successfully!"),h({name:packageData.name||"",task:packageData.task||"",features:packageData.features?packageData.features.split(","):[],selectedFeatureData:packageData.selectedFeatureData||[],actualinr:packageData.actualinr||"",membersinr:packageData.membersinr||"",brcoinsinr:packageData.brcoinsinr||"",actualusd:packageData.actualusd||"",membersusd:packageData.membersusd||"",brcoinsusd:packageData.brcoinsusd||"",data:packageData.data||[]}),N([]),fetchData()):C.error(u.msg)}catch(c){console.log("Error updating package:",c)}},U=async r=>{try{const c=await(await fetch(`http://localhost:5000/api/package/getpackageByid/${r}`)).json();if(c.msg&&c.msg.length>0){const s=c.msg[0];h({name:s.name||"",task:s.task||"",features:s.features?s.features.split(","):[],selectedFeatureData:s.selectedFeatureData||[],actualinr:s.actualinr||"",membersinr:s.membersinr||"",brcoinsinr:s.brcoinsinr||"",actualusd:s.actualusd||"",membersusd:s.membersusd||"",brcoinsusd:s.brcoinsusd||""})}else console.log("No package data found")}catch(a){console.log("Error fetching package:",a)}};return p.useEffect(()=>{B(),g&&U(g),M()},[g]),e.jsx(e.Fragment,{children:e.jsx(n,{onSubmit:A,children:e.jsx(x,{className:"mb-5 form-templates",children:e.jsx(m,{lg:12,children:e.jsx(I,{children:e.jsx(I.Body,{children:e.jsxs(x,{className:"mb-3 align-items-center",children:[e.jsx(m,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(n.Label,{children:"Packagex Name"}),e.jsx(n.Control,{name:"name",value:t.name,onChange:r=>h({...t,name:r.target.value}),type:"text",placeholder:"Enter Package Name"}),j.name&&e.jsx("span",{className:"text-danger",children:j.name})]})}),e.jsx(m,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(n.Label,{children:"Select Task Group"}),e.jsx(w,{options:y,name:"task",value:y.find(r=>r.value===t.task)||null,onChange:r=>h({...t,task:r?r.value:""})}),j.task&&e.jsx("span",{className:"text-danger",children:j.task})]})}),e.jsx(m,{md:12,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(n.Label,{children:"Select Fixed Features"}),e.jsx(w,{options:v,isMulti:!0,value:v.filter(r=>{var a;return(a=t.features)==null?void 0:a.includes(r.value)})||[],name:"features",onChange:$,placeholder:"Choose..."}),j.features&&e.jsx("span",{className:"text-danger",children:j.features})]})}),f.map((r,a)=>e.jsx(m,{md:6,children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"card_wrapper",children:[e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Feature Name :"}),e.jsx("h5",{children:r.itemname})," "]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Actual Price INR :"}),e.jsxs("div",{children:[e.jsx(n.Control,{type:"hidden",name:`itemid[${a}]`,value:r.itemid}),e.jsx(n.Control,{type:"text",name:`actualinrpackage[${a}]`,value:r.actualinrpackage,onChange:c=>d(c,a,"actualinrpackage"),placeholder:"Enter INR Price"})]})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Members Only Price INR :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`membersinrpackage[${a}]`,value:r.membersinrpackage,onChange:c=>d(c,a,"membersinrpackage"),placeholder:"Enter INR Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"BR Coins Price INR :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`brcoinsinrpackage[${a}]`,value:r.brcoinsinrpackage,onChange:c=>d(c,a,"brcoinsinrpackage"),placeholder:"Enter INR Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Actual Price USD :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`actualusdpackage[${a}]`,value:r.actualusdpackage,onChange:c=>d(c,a,"actualusdpackage"),placeholder:"Enter USD Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Members Only USD :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`membersusdpackage[${a}]`,value:r.membersusdpackage,onChange:c=>d(c,a,"membersusdpackage"),placeholder:"Enter USD Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"BR Coins Price USD :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`brcoinsusdpackage[${a}]`,value:r.brcoinsusdpackage,onChange:c=>d(c,a,"brcoinsusdpackage"),placeholder:"Enter USD Price"})})]})]})})},a)),E.map((r,a)=>e.jsxs(m,{md:6,children:[" ",e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"card_wrapper",children:[e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Feature Name :"}),e.jsx("h5",{children:r.label})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Actual Price INR :"}),e.jsxs("div",{children:[e.jsx(n.Control,{type:"hidden",name:`itemid[${a}]`,value:r.value}),e.jsx(n.Control,{type:"text",name:`actualinrpackage[${a}]`,value:r.actualinr||"",onChange:c=>d(c,a,"actualinr"),placeholder:"Enter INR Price"})]})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Members Only Price INR :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`membersinrpackage[${a}]`,value:r.membersinr,onChange:c=>d(c,a,"membersinr"),placeholder:"Enter INR Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"BR Coins Price INR :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`brcoinsinrpackage[${a}]`,value:r.brcoinsinr,onChange:c=>d(c,a,"brcoinsinr"),placeholder:"Enter INR Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Actual Price USD :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`actualusdpackage[${a}]`,value:r.actualusd||"",onChange:c=>d(c,a,"actualusd"),placeholder:"Enter USD Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"Members Only USD :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`membersusdpackage[${a}]`,value:r.membersusd||"",onChange:c=>d(c,a,"membersusd"),placeholder:"Enter USD Price"})})]}),e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:"BR Coins Price USD :"}),e.jsx("div",{children:e.jsx(n.Control,{type:"text",name:`brcoinsusdpackage[${a}]`,value:r.brcoinsusd||"",onChange:c=>d(c,a,"brcoinsusd"),placeholder:"Enter USD Price"})})]})]})})]},a)),e.jsxs(x,{children:[e.jsx("h5",{children:"Pricing"}),e.jsx("h6",{children:"INR"}),e.jsx(m,{lg:6,children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(n.Label,{children:"Actual"}),e.jsx(n.Control,{type:"text",value:t.actualinr,onChange:b,name:"actualinr",placeholder:"Actual"})]})})}),e.jsx(m,{lg:6,children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(n.Label,{children:"MEMBERS ONLY PRICE"}),e.jsx(n.Control,{type:"text",value:t.membersinr,onChange:b,name:"membersinr",placeholder:"MEMBERS ONLY PRICE"})]})})}),e.jsx(m,{lg:6,children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(n.Label,{children:"BR COINS PRICE"}),e.jsx(n.Control,{type:"text",value:t.brcoinsinr,onChange:b,name:"brcoinsinr",placeholder:"BR COINS PRICE"})]})})})]}),e.jsxs(x,{children:[e.jsx("h6",{children:"USD"}),e.jsx(m,{lg:6,children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(n.Label,{children:"Actual"}),e.jsx(n.Control,{type:"text",value:t.actualusd,onChange:b,name:"actualusd",placeholder:"Actual"})]})})}),e.jsx(m,{lg:6,children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(n.Label,{children:"MEMBERS ONLY PRICE"}),e.jsx(n.Control,{type:"text",value:t.membersusd,onChange:b,name:"membersusd",placeholder:"MEMBERS ONLY PRICE"})]})})}),e.jsx(m,{lg:6,children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(n.Label,{children:"BR COINS PRICE"}),e.jsx(n.Control,{type:"text",value:t.brcoinsusd,onChange:b,name:"brcoinsusd",placeholder:"BR COINS PRICE"})]})})})]}),e.jsx("div",{className:"text-end",children:e.jsx(T,{type:"submit",className:"waves-effect waves-light",variant:"primary",children:"Submit"})})]})})})})})})})};export{V as default};
