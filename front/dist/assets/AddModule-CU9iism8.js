import{G as T,c as ce,r as o,j as e,R as de,C as R,B as P,b as i}from"./index-CqonvCgs.js";import{X as pe}from"./index.es-CzlDxkiB.js";import{S as y}from"./react-select.esm-C0W1OJnW.js";import{M as _}from"./Modal-BVFbfr82.js";import{R as D,C as j}from"./Row-kCx33sI5.js";import{F as d}from"./Form-BsIrG47u.js";import"./setPrototypeOf-DgZC2w_0.js";import"./CloseButton-CRqNhKfH.js";function me(c){return T({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"},child:[]}]})(c)}function ue(c){return T({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(c)}function he(c){return T({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M21 11H6.83l3.58-3.59L9 6l-6 6 6 6 1.41-1.41L6.83 13H21z"},child:[]}]})(c)}const Ce=()=>{const{id:c}=ce(),A=!!c;o.useState("");const[p,m]=o.useState([{name:"status",validation:"Auto Save",inputtype:"",ids:""},{name:"createdBy",validation:"Auto Save",inputtype:"",ids:""},{name:"createdDate",validation:"Auto Save",inputtype:"",ids:""},{name:"",validation:"",inputtype:"",ids:""}]),[H,ge]=o.useState("");o.useState([""]);const[I,L]=o.useState([]),G=()=>{m([...p,{name:"",validation:"",inputtype:""}])},J=async(n,a)=>{if(a==null){const t=p.filter((s,l)=>l!==n);m(t)}else try{const t=await fetch(`http://localhost:5000/api/form/deletefield/${a}`,{method:"DELETE"}),s=await t.json();t.ok==!0?(w(),i.success(s.msg)):i.error(s.extraDetails?s.extraDetails:s.msg)}catch(t){console.log(t)}},h=(n,a,t)=>{const s=p.map((l,E)=>E===n?t?{...l,[t]:a.value}:{...l,[a.target.name]:a.target.value}:l);m(s)},U=p.filter(n=>n.name.toLowerCase().includes(H.toLowerCase())||n.length.toString().includes(H)),[g,b]=o.useState(""),X=n=>{b(n.target.value)},M=[{value:"Auto Save",label:"Auto Save"},{value:"Optional",label:"Optional"},{value:"Required",label:"Required"}],k=[{value:"Text",label:"Text"},{value:"Single Select",label:"Single Select"},{value:"Multi Select",label:"Multi Select"},{value:"Textarea",label:"Textarea"},{value:"file",label:"file"},{value:"Radio",label:"Radio"},{value:"CheckBox",label:"CheckBox"},{value:"DatePicker",label:"DatePicker"},{value:"Data Editor",label:"Data Editor"}],[r,x]=o.useState({}),K=async n=>{n.preventDefault();const a={};if(g||(a.table_name="Page name is required"),S||(a.selectedOption="Select option is required"),p.forEach((t,s)=>{s>=3&&(!t.name||!t.validation||!t.inputtype)&&(a.rowErrors=a.rowErrors||[],a.rowErrors.push(`Row ${s+1} is incomplete`))}),Object.keys(a).length>0){x(a);return}if(A)try{const t=await fetch(`http://localhost:5000/api/form/updatepages/${c}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({table_name:g,fields:p,selectedOption1:S})}),s=await t.json();t.ok?(s.error==!0?i.error(s.extraDetails||s.message):i.success("Module updated successfully!"),w(),x({})):i.error(s.extraDetails||s.message)}catch(t){console.error("Error adding module:",t),i.error("An error occurred.")}else try{const t=await fetch("http://localhost:5000/api/form/createpages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table_name:g,fields:p,selectedOption1:S})}),s=await t.json();t.ok?(s.error==!0?i.error(s.extraDetails||s.message):i.success("Module added successfully!"),m([{name:"status",validation:"Auto Save",inputtype:"",ids:""},{name:"createdBy",validation:"Auto Save",inputtype:"",ids:""},{name:"createdDate",validation:"Auto Save",inputtype:"",ids:""},{name:"",validation:"",inputtype:"",ids:""}]),b(""),C(""),x({})):i.error(s.extraDetails||s.message)}catch(t){console.error("Error adding module:",t),i.error("An error occurred.")}},[Q,W]=o.useState([]);o.useState([]);const[f,Y]=o.useState(""),w=async()=>{try{const a=await(await fetch(`http://localhost:5000/api/form/get/${c}`,{method:"GET"})).json();b(a.page[0].page_name),Y(a.page[0].icon_id),v(),m(a.fields.map(t=>({name:t.fields_name,validation:t.fields_validation,inputtype:t.fields_type||"",dropdown:t.dropdown,ids:t._id||""})))}catch(n){console.error("Error adding module:",n)}},B=async()=>{try{const a=await(await fetch("http://localhost:5000/api/form/getPageOptions",{method:"GET"})).json(),t=Array.isArray(a.msg)?a.msg.map(s=>({value:s.table_name,label:s.page_name||s.page_name})):[];L(t)}catch(n){console.error("Error fetching page options:",n)}},v=async()=>{try{const a=await(await fetch("http://localhost:5000/api/form/getSidebarOptions",{method:"GET"})).json(),l=[...(Array.isArray(a.msg)?a.msg:[]).map(u=>({value:u._id,label:u.icontitle,image:`http://localhost:5000/sidebar/${u.icon}`})),{value:"Others",label:"Others",image:"/src/assets/images/sidebar/dashboard.svg"}];W(l);const E=f,q=l.find(u=>u.value===E);q&&($(q),C(f))}catch(n){console.error("Error fetching sidebar options:",n)}};o.useEffect(()=>{(async()=>{await w()})()},[c]),o.useEffect(()=>{f&&(v(),B()),v(),B()},[f]),o.useState(null);const Z=[{name:"Name",cell:(n,a)=>{var t;return a>=3?e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"name",className:"form-control",value:n.name,onChange:s=>h(a,s),placeholder:"Enter name"}),!n.name&&((t=r.rowErrors)==null?void 0:t.includes(`Row ${a+1} is incomplete`))&&e.jsx("small",{className:"text-danger",children:"Name is required"})]}):null}},{name:"Field",cell:(n,a)=>{var t;return a>=3?e.jsxs("div",{children:[e.jsx(y,{options:M,name:"validation",value:M.find(s=>s.value===n.validation),onChange:s=>h(a,s,"validation"),menuPortalTarget:document.body,menuPosition:"fixed",styles:{menuPortal:s=>({...s,zIndex:9999}),control:s=>{var l;return{...s,minHeight:"40px",borderColor:(l=r.rowErrors)!=null&&l.includes(`Row ${a+2} is incomplete`)?"red":s.borderColor}}}}),!n.validation&&((t=r.rowErrors)==null?void 0:t.includes(`Row ${a+1} is incomplete`))&&e.jsx("small",{className:"text-danger",children:"Field is required"})]}):null}},{name:"Field Type",cell:(n,a)=>{var t;return a>=3?e.jsxs("div",{children:[e.jsx(y,{options:k,name:"inputtype",value:k.find(s=>s.value===n.inputtype),onChange:s=>h(a,s,"inputtype"),menuPortalTarget:document.body,menuPosition:"fixed",styles:{menuPortal:s=>({...s,zIndex:9999}),control:s=>{var l;return{...s,minHeight:"40px",borderColor:(l=r.rowErrors)!=null&&l.includes(`Row ${a+2} is incomplete`)?"red":s.borderColor}}}}),!n.inputtype&&((t=r.rowErrors)==null?void 0:t.includes(`Row ${a+1} is incomplete`))&&e.jsx("small",{className:"text-danger",children:"Field Type is required"})]}):null}},{name:"",cell:(n,a)=>a>=3?e.jsx("div",{children:(n.inputtype==="Single Select"||n.inputtype==="Multi Select")&&e.jsx(y,{options:I,name:"dropdown",value:I.find(t=>t.value===n.dropdown),onChange:t=>h(a,t,"dropdown"),menuPortalTarget:document.body,menuPosition:"fixed",styles:{menuPortal:t=>({...t,zIndex:9999}),control:t=>{var s;return{...t,minHeight:"40px",borderColor:(s=r.rowErrors)!=null&&s.includes(`Row ${a+2} is incomplete`)?"red":t.borderColor}}}})}):null},{name:"Actions",cell:(n,a)=>e.jsx("div",{className:"d-flex align-items-center",children:a>=(A?"3":"4")?e.jsx("a",{onClick:()=>J(a,n.ids),className:"btn btn-outline-danger btn-sm edit",title:"Delete",children:e.jsx(ue,{})}):null})}],[S,C]=o.useState(null),[ee,$]=o.useState(null),[te,O]=o.useState(!1),ae=()=>O(!1),se=(n,a,t)=>{$(a),C(a.value),a.value==="Others"&&O(!0)},[V,z]=o.useState(),[N,F]=o.useState(),ne=async n=>{F(n.target.value)},oe=n=>{z(n.target.files[0])},le=async n=>{n.preventDefault();const a={};if(N||(a.icontitle="Icon title is required"),V||(a.icon="File is required"),Object.keys(a).length>0)x(a);else try{const t=new FormData;t.append("icontitle",N),t.append("icon",V);const s=await fetch("http://localhost:5000/api/form/addsidebaricon",{method:"POST",body:t}),l=await s.json();s.ok?(i.success("Icon Added successfully!"),F(""),z(""),O(!1),v()):i.error(l.extraDetails||l.msg)}catch(t){console.error("Error adding module:",t)}},re=({data:n,innerRef:a,innerProps:t})=>e.jsxs("div",{ref:a,...t,style:{display:"flex",alignItems:"center",padding:"10px"},children:[e.jsx("img",{src:n.image,alt:n.label,style:{width:"25px",height:"25px",marginRight:"12px"}}),n.label]}),ie=({data:n})=>e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("img",{src:n.image,alt:n.label,style:{width:"25px",height:"25px",marginRight:"12px"}}),n.label]});return e.jsxs(de.Fragment,{children:[e.jsx(D,{children:e.jsx(j,{lg:12,children:e.jsx("form",{onSubmit:K,children:e.jsxs(R,{className:"create_new_page_card add-module add-module-table",children:[e.jsx(R.Header,{children:e.jsxs(D,{className:"",children:[e.jsx(j,{lg:4,children:e.jsx("div",{className:"data_tableHeader",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(d.Label,{children:"Page Name"}),e.jsx(d.Control,{type:"text",value:g,onChange:X,name:"table_name",placeholder:"Page Name"}),r.table_name&&e.jsx("span",{className:"text-danger pg-er",children:r.table_name})]})})}),e.jsx(j,{lg:4,children:e.jsxs("div",{className:"data_tableHeader",children:[e.jsx(d.Label,{children:"Select Title"}),e.jsx(y,{options:Q,value:ee,onchange:"handleDropdownChange()",onChange:n=>se(0,n),components:{Option:re,SingleValue:ie}}),r.selectedOption&&e.jsx("span",{className:"text-danger pg-er",children:r.selectedOption})]})})]})}),e.jsxs(R.Body,{children:[e.jsx(pe,{columns:Z,data:U,responsive:!0,striped:!0}),e.jsxs(P,{className:"waves-effect waves-light",variant:"primary",onClick:G,style:{marginRight:"5px",marginTop:"20px"},children:[e.jsx(me,{})," Add Row"]}),e.jsx(D,{children:e.jsx(j,{lg:12,children:e.jsxs("div",{className:"d-flex justify-content-between mt-3 align-items-center",children:[e.jsx("div",{className:"text-end",children:e.jsxs("a",{href:"/module/module-list",className:"back-button",variant:"primary",children:[e.jsx(he,{})," Back"]})}),e.jsx("div",{className:"text-end",children:e.jsx(P,{type:"submit",className:"waves-effect waves-light",variant:"primary",children:"Submit"})})]})})})]})]})})})}),e.jsxs(_,{show:te,onHide:ae,className:"other-icon-modal",children:[e.jsx(_.Header,{closeButton:!0}),e.jsxs(_.Body,{children:[e.jsx("h3",{children:"Upload Other Icons"}),e.jsxs("form",{onSubmit:le,children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"search-input mb-1",children:[e.jsx(d.Label,{children:"Icon Title"}),e.jsx(d.Control,{type:"text",value:N,onChange:ne,name:"icontitle",placeholder:"Page Name"}),r.icontitle&&e.jsx("span",{className:"text-danger",children:r.icontitle})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(d.Group,{className:"mb-3",controlId:"PageName",children:[e.jsx(d.Label,{children:"Upload Icon"}),e.jsx(d.Control,{type:"file",name:"file",onChange:oe,placeholder:"Page Name"})]}),r.icon&&e.jsx("span",{className:"text-danger",children:r.icon})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(P,{variant:"primary",type:"submit",children:"Submit"})})]})]})]})]})};export{Ce as default};
